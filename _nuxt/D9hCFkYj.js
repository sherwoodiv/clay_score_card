import{q as J,N as M,ai as ie,ag as W,v as z,y as ue,s as Y,h as E,x as oe,aj as de,f as D,o as w,w as V,b as R,r as le,i as b,A as F,a7 as $,P as ae,T as ce,M as ne,ak as Q,al as fe,am as ve,an as pe,C as he,D as ge,G as X,S as me,O as ye,c as O,a as P,n as _,m as be,H as Z,J as xe,p as ee,K as te,t as Ce}from"./DwUPif7m.js";import{u as ke}from"./CgwzwKe5.js";import{R as Te,M as Ie,u as Ke,a as Se}from"./BYpu07zL.js";import Ae from"./Dmdqyiwv.js";function H(n,l,e){const o=n.findIndex(c=>J(c,l)),x=n.findIndex(c=>J(c,e));if(o===-1||x===-1)return[];const[t,u]=[o,x].sort((c,d)=>c-d);return n.slice(t,u+1)}function _e(n,l){const e=M(),o=(t,u)=>{if(l.multiple&&Array.isArray(n.value))if(l.selectionBehavior==="replace")n.value=[t],e.value=t;else{const c=n.value.findIndex(d=>u(d));c!==-1?n.value=n.value.filter((d,v)=>v!==c):n.value=[...n.value,t]}else l.selectionBehavior==="replace"?n.value={...t}:!Array.isArray(n.value)&&u(n.value)?n.value=void 0:n.value={...t};return n.value};function x(t,u,c,d){if(!e?.value||!l.multiple||!Array.isArray(n.value))return;const T=c().filter(g=>g.ref.dataset.disabled!=="").find(g=>g.ref===u)?.value;if(!T)return;let C=null;switch(t){case"prev":case"next":{C=H(d,e.value,T);break}case"first":{C=H(d,e.value,d?.[0]);break}case"last":{C=H(d,e.value,d?.[d.length-1]);break}}n.value=C}return{firstValue:e,onSelectItem:o,handleMultipleReplace:x}}function we(n){const l=ie("",1e3);return{search:l,handleTypeaheadSearch:(x,t)=>{l.value=l.value+x;{const u=W(),c=t.map(g=>({...g,textValue:g.value?.textValue??g.ref.textContent?.trim()??""})),d=c.find(g=>g.ref===u),v=c.map(g=>g.textValue),T=qe(v,l.value,d?.textValue),C=c.find(g=>g.textValue===T);return C&&C.ref.focus(),C?.ref}},resetTypeahead:()=>{l.value=""}}}function Ee(n,l){return n.map((e,o)=>n[(l+o)%n.length])}function qe(n,l,e){const x=l.length>1&&Array.from(l).every(v=>v===l[0])?l[0]:l,t=e?n.indexOf(e):-1;let u=Ee(n,Math.max(t,0));x.length===1&&(u=u.filter(v=>v!==e));const d=u.find(v=>v.toLowerCase().startsWith(x.toLowerCase()));return d!==e?d:void 0}function j(n){return n.reduce((l,e)=>(l.push(e),e.children&&l.push(...j(e.children)),l),[])}const[Re,Ve]=oe("TreeRoot");var Be=z({__name:"TreeRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},items:{type:Array,required:!1},expanded:{type:Array,required:!1},defaultExpanded:{type:Array,required:!1},getKey:{type:Function,required:!0},getChildren:{type:Function,required:!1,default:n=>n.children},selectionBehavior:{type:String,required:!1,default:"toggle"},multiple:{type:Boolean,required:!1,skipCheck:!0},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},propagateSelect:{type:Boolean,required:!1},bubbleSelect:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"ul"}},emits:["update:modelValue","update:expanded"],setup(n,{emit:l}){const e=n,o=l,{items:x,multiple:t,disabled:u,propagateSelect:c,dir:d,bubbleSelect:v}=ue(e),{handleTypeaheadSearch:T}=we(),C=ke(d),g=M(),q=M(!1),B=de(),r=Y(e,"modelValue",o,{defaultValue:e.defaultValue??(t.value?[]:void 0),passive:!0,deep:!0}),p=Y(e,"expanded",o,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:a,handleMultipleReplace:s}=_e(r,e),i=E(()=>t.value&&Array.isArray(r.value)?r.value.map(f=>e.getKey(f)):[e.getKey(r.value??{})]);function h(f,y=1,S){return f.reduce((k,A,N)=>{const U=e.getKey(A),G=e.getChildren(A),re=p.value.includes(U),se={_id:U,value:A,index:N,level:y,parentItem:S,hasChildren:!!G,bind:{value:A,level:y,"aria-setsize":f.length,"aria-posinset":N+1}};return k.push(se),G&&re&&k.push(...h(G,y+1,A)),k},[])}const m=E(()=>{const f=e.items;return p.value.map(y=>y),h(f??[])});function I(f){if(q.value)B.trigger(f);else{const y=g.value?.getItems()??[];T(f.key,y)}}function K(f){if(q.value)return;const y=Ie[f.key];ce(()=>{s(y,W(),g.value?.getItems,m.value.map(S=>S.value))})}function L(f){if(f.parentItem!=null&&Array.isArray(r.value)&&e.multiple){const y=m.value.find(S=>f.parentItem!=null&&e.getKey(S.value)===e.getKey(f.parentItem));y!=null&&(e.getChildren(y.value)?.every(k=>r.value.find(A=>e.getKey(A)===e.getKey(k)))?r.value=[...r.value,y.value]:r.value=r.value.filter(k=>e.getKey(k)!==e.getKey(y.value)),L(y))}}return Ve({modelValue:r,selectedKeys:i,onSelect:f=>{const y=k=>e.getKey(k??{})===e.getKey(f),S=e.multiple&&Array.isArray(r.value)?r.value?.findIndex(y)!==-1:void 0;if(a(f,y),e.bubbleSelect&&e.multiple&&Array.isArray(r.value)){const k=m.value.find(A=>e.getKey(A.value)===e.getKey(f));k!=null&&L(k)}if(e.propagateSelect&&e.multiple&&Array.isArray(r.value)){const k=j(e.getChildren(f)??[]);S?r.value=[...r.value].filter(A=>!k.some(N=>e.getKey(A??{})===e.getKey(N))):r.value=[...r.value,...k]}},expanded:p,onToggle(f){if(!(f?e.getChildren(f):void 0))return;const S=e.getKey(f)??f;p.value.includes(S)?p.value=p.value.filter(k=>k!==S):p.value.push(S)},getKey:e.getKey,getChildren:e.getChildren,items:x,expandedItems:m,disabled:u,multiple:t,dir:C,propagateSelect:c,bubbleSelect:v,isVirtual:q,virtualKeydownHook:B,handleMultipleReplace:s}),(f,y)=>(w(),D(b(Te),{ref_key:"rovingFocusGroupRef",ref:g,"as-child":"",orientation:"vertical",dir:b(C)},{default:V(()=>[R(b(ae),{role:"tree",as:f.as,"as-child":f.asChild,"aria-multiselectable":b(t)?!0:void 0,onKeydown:[I,F($(K,["shift"]),["up","down"])]},{default:V(()=>[le(f.$slots,"default",{flattenItems:m.value,modelValue:b(r),expanded:b(p)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),Le=Be;const Me="tree.select",Oe="tree.toggle";var $e=z({inheritAttrs:!1,__name:"TreeItem",props:{value:{type:null,required:!0},level:{type:Number,required:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"li"}},emits:["select","toggle"],setup(n,{expose:l,emit:e}){const o=n,x=e,t=Re(),{getItems:u}=Ke(),c=E(()=>!!t.getChildren(o.value)),d=E(()=>{const a=t.getKey(o.value);return t.expanded.value.includes(a)}),v=E(()=>{const a=t.getKey(o.value);return t.selectedKeys.value.includes(a)}),T=E(()=>{if(t.bubbleSelect.value&&c.value&&Array.isArray(t.modelValue.value)){const a=j(t.getChildren(o.value)||[]);return a.some(s=>t.modelValue.value.find(i=>t.getKey(i)===t.getKey(s)))&&!a.every(s=>t.modelValue.value.find(i=>t.getKey(i)===t.getKey(s)))}else return t.propagateSelect.value&&v.value&&c.value&&Array.isArray(t.modelValue.value)?!j(t.getChildren(o.value)||[]).every(s=>t.modelValue.value.find(i=>t.getKey(i)===t.getKey(s))):void 0});function C(a){if(c.value)if(d.value){const s=u().map(K=>K.ref),i=W(),h=s.indexOf(i),I=[...s].slice(h).find(K=>Number(K.getAttribute("data-indent"))===o.level+1);I&&I.focus()}else p(a)}function g(a){if(d.value)p(a);else{const s=u().map(K=>K.ref),i=W(),h=s.indexOf(i),I=[...s].slice(0,h).reverse().find(K=>Number(K.getAttribute("data-indent"))===o.level-1);I&&I.focus()}}async function q(a){x("select",a),!a?.defaultPrevented&&t.onSelect(o.value)}async function B(a){x("toggle",a),!a?.defaultPrevented&&t.onToggle(o.value)}async function r(a){if(!a)return;const s={originalEvent:a,value:o.value,isExpanded:d.value,isSelected:v.value};Q(Me,q,s)}async function p(a){if(!a)return;const s={originalEvent:a,value:o.value,isExpanded:d.value,isSelected:v.value};Q(Oe,B,s)}return l({isExpanded:d,isSelected:v,isIndeterminate:T,handleToggle:()=>t.onToggle(o.value),handleSelect:()=>t.onSelect(o.value)}),(a,s)=>(w(),D(b(Se),{"as-child":"",value:a.value,"allow-shift-key":""},{default:V(()=>[R(b(ae),ne(a.$attrs,{role:"treeitem",as:a.as,"as-child":a.asChild,"aria-selected":v.value,"aria-expanded":c.value?d.value:void 0,"aria-level":a.level,"data-indent":a.level,"data-selected":v.value?"":void 0,"data-expanded":d.value?"":void 0,onKeydown:[F($(r,["self","prevent"]),["enter","space"]),s[0]||(s[0]=F($(i=>b(t).dir.value==="ltr"?C(i):g(i),["prevent"]),["right"])),s[1]||(s[1]=F($(i=>b(t).dir.value==="ltr"?g(i):C(i),["prevent"]),["left"]))],onClick:s[2]||(s[2]=$(i=>{r(i),p(i)},["stop"]))}),{default:V(()=>[le(a.$slots,"default",{isExpanded:d.value,isSelected:v.value,isIndeterminate:T.value,handleSelect:()=>b(t).onSelect(a.value),handleToggle:()=>b(t).onToggle(a.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),De=$e;function Ne(n={}){const{inheritAttrs:l=!0}=n,e=fe(),o=z({setup(t,{slots:u}){return()=>{e.value=u.default}}}),x=z({inheritAttrs:l,props:n.props,setup(t,{attrs:u,slots:c}){return()=>{var d;e.value;const v=(d=e.value)==null?void 0:d.call(e,{...n.props==null?Pe(u):t,$slots:c});return l&&v?.length===1?v[0]:v}}});return ve({define:o,reuse:x},[o,x])}function Pe(n){const l={};for(const e in n)l[pe(e)]=n[e];return l}const Fe={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-highlighted before:bg-elevated"},false:{link:["hover:text-highlighted hover:before:bg-elevated/50","transition-colors before:transition-colors"]}}}},He=Object.assign({inheritAttrs:!1},{__name:"ProseCodeTree",props:{defaultValue:{type:String,required:!1},expandAll:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(n){const l=n,e=he(),o=ge(),[x,t]=Ne(),u=E(()=>X({extend:X(Fe),...o.ui?.prose?.codeTree||{}})()),c=M(l.defaultValue?{path:l.defaultValue}:void 0),d=M(),v=M(1),T=E(()=>(v.value,e.default?.()?.flatMap(q).filter(Boolean)||[])),C=E(()=>g(T.value));function g(r){const p=new Map,a=[];r.forEach(i=>{const h=i.label.split("/");let m="";h.forEach((I,K)=>{if(m=m?`${m}/${I}`:I,!p.has(m)){const L={label:I,path:m,...K<h.length-1&&{children:[]}};p.set(m,L),K===0?a.push(L):p.get(h.slice(0,K).join("/"))?.children?.push(L)}})});const s=i=>i.sort((h,m)=>!!h.children==!!m.children?h.label.localeCompare(m.label):m.children?1:-1).map(h=>({...h,children:h.children&&s(h.children)}));return s(a)}function q(r,p){return typeof r.type=="symbol"?r.children?.map(q):{label:r.props?.filename||r.props?.label||`${p}`,icon:r.props?.icon,component:r}}const B=E(()=>{if(l.expandAll){const a=new Set;return T.value.forEach(s=>{const i=s.label.split("/");for(let h=1;h<i.length;h++)a.add(i.slice(0,h).join("/"))}),Array.from(a)}const r=c.value?.path;if(!r)return[];const p=r.split("/");return p.map((a,s)=>p.slice(0,s+1).join("/"))});return me(c,r=>{const p=T.value.find(a=>r?.path===a.label);p?.component&&(d.value=p)},{immediate:!0}),ye(()=>v.value++),(r,p)=>(w(),O(Z,null,[R(b(x),null,{default:V(({items:a,level:s})=>[(w(!0),O(Z,null,xe(a,(i,h)=>(w(),O("li",{key:`${s}-${h}`,role:"presentation",class:_(s>1?u.value.itemWithChildren({class:l.ui?.itemWithChildren}):u.value.item({class:l.ui?.item}))},[R(b(De),{level:s,value:i,"as-child":""},{default:V(({isExpanded:m,isSelected:I})=>[P("button",{type:"button",class:_(u.value.link({class:l.ui?.link,active:I}))},[i.children?.length?(w(),D(te,{key:0,name:m?b(o).ui.icons.folderOpen:b(o).ui.icons.folder,class:_(u.value.linkLeadingIcon({class:l.ui?.linkLeadingIcon}))},null,8,["name","class"])):(w(),D(Ae,{key:1,filename:i.label,class:_(u.value.linkLeadingIcon({class:l.ui?.linkLeadingIcon}))},null,8,["filename","class"])),P("span",{class:_(u.value.linkLabel({class:l.ui?.linkLabel}))},Ce(i.label),3),i.children?.length?(w(),O("span",{key:2,class:_(u.value.linkTrailing({class:l.ui?.linkTrailing}))},[R(te,{name:b(o).ui.icons.chevronDown,class:_(u.value.linkTrailingIcon({class:l.ui?.linkTrailingIcon}))},null,8,["name","class"])],2)):ee("",!0)],2),i.children?.length&&m?(w(),O("ul",{key:0,role:"group",class:_(u.value.listWithChildren({class:l.ui?.listWithChildren}))},[R(b(t),{items:i.children,level:s+1},null,8,["items","level"])],2)):ee("",!0)]),_:2},1032,["level","value"])],2))),128))]),_:1}),P("div",ne(r.$attrs,{class:u.value.root({class:[l.ui?.root,l.class]})}),[R(b(Le),{modelValue:c.value,"onUpdate:modelValue":p[0]||(p[0]=a=>c.value=a),class:_(u.value.list({class:l.ui?.list})),items:C.value,"get-key":a=>a.path,"default-expanded":B.value},{default:V(()=>[R(b(t),{items:C.value,level:1},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),P("div",{class:_(u.value.content({class:l.ui?.content}))},[(w(),D(be(d.value?.component)))],2)],16)],64))}});export{He as default};

import{I as y,g as w,a9 as L,aa as V,m as E,ab as Y,ac as j,ad as C,ae as R,T as z,af as H,V as _,q as J,l as Q,p as W,i as x,o as K,w as A,b as O,v as d,P as B,r as P,y as X,R as Z,ag as ee,Y as te}from"./C84G-s-j.js";import{u as oe}from"./CjkbC1OF.js";function M(){const t=y(),n=w(()=>["#text","#comment"].includes(t.value?.$el.nodeName)?t.value?.$el.nextElementSibling:L(t));return{primitiveElement:t,currentElement:n}}const q="data-reka-collection-item";function N(t={}){const{key:n="",isProvider:r=!1}=t,s=`${n}CollectionProvider`;let i;if(r){const a=y(new Map);i={collectionRef:y(),itemMap:a},H(s,i)}else i=V(s);const S=(a=!1)=>{const o=i.collectionRef.value;if(!o)return[];const l=Array.from(o.querySelectorAll(`[${q}]`)),p=Array.from(i.itemMap.value.values()).sort((v,b)=>l.indexOf(v.ref)-l.indexOf(b.ref));return a?p:p.filter(v=>v.ref.dataset.disabled!=="")},m=E({name:"CollectionSlot",setup(a,{slots:o}){const{primitiveElement:l,currentElement:f}=M();return z(f,()=>{i.collectionRef.value=f.value}),()=>C(R,{ref:l},o)}}),F=E({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:o,attrs:l}){const{primitiveElement:f,currentElement:p}=M();return Y(v=>{if(p.value){const b=j(p.value);i.itemMap.value.set(b,{ref:p.value,value:a.value}),v(()=>i.itemMap.value.delete(b))}}),()=>C(R,{...l,[q]:"",ref:f},o)}}),g=w(()=>Array.from(i.itemMap.value.values())),e=w(()=>i.itemMap.value.size);return{getItems:S,reactiveItems:g,itemMapSize:e,CollectionSlot:m,CollectionItem:F}}const ae="rovingFocusGroup.onEntryFocus",re={bubbles:!1,cancelable:!0},ne={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function se(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function ie(t,n,r){const s=se(t.key,r);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return ne[s]}function D(t,n=!1){const r=_();for(const s of t)if(s===r||(s.focus({preventScroll:n}),_()!==r))return}function le(t,n){return t.map((r,s)=>t[(n+s)%t.length])}const[ue,ce]=W("RovingFocusGroup");var de=E({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(t,{expose:n,emit:r}){const s=t,i=r,{loop:S,orientation:m,dir:F}=J(s),g=oe(F),e=Q(s,"currentTabStopId",i,{defaultValue:s.defaultCurrentTabStopId,passive:s.currentTabStopId===void 0}),a=y(!1),o=y(!1),l=y(0),{getItems:f,CollectionSlot:p}=N({isProvider:!0});function v(u){const I=!o.value;if(u.currentTarget&&u.target===u.currentTarget&&I&&!a.value){const T=new CustomEvent(ae,re);if(u.currentTarget.dispatchEvent(T),i("entryFocus",T),!T.defaultPrevented){const h=f().map(c=>c.ref).filter(c=>c.dataset.disabled!==""),$=h.find(c=>c.getAttribute("data-active")===""),k=h.find(c=>c.getAttribute("data-highlighted")===""),U=h.find(c=>c.id===e.value),G=[$,k,U,...h].filter(Boolean);D(G,s.preventScrollOnEntryFocus)}}o.value=!1}function b(){setTimeout(()=>{o.value=!1},1)}return n({getItems:f}),ce({loop:S,dir:g,orientation:m,currentTabStopId:e,onItemFocus:u=>{e.value=u},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{l.value++},onFocusableItemRemove:()=>{l.value--}}),(u,I)=>(K(),x(d(p),null,{default:A(()=>[O(d(B),{tabindex:a.value||l.value===0?-1:0,"data-orientation":d(m),as:u.as,"as-child":u.asChild,dir:d(g),style:{outline:"none"},onMousedown:I[0]||(I[0]=T=>o.value=!0),onMouseup:b,onFocus:v,onBlur:I[1]||(I[1]=T=>a.value=!1)},{default:A(()=>[P(u.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),me=de,fe=E({__name:"RovingFocusItem",props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(t){const n=t,r=ue(),s=X(),i=w(()=>n.tabStopId||s),S=w(()=>r.currentTabStopId.value===i.value),{getItems:m,CollectionItem:F}=N();Z(()=>{n.focusable&&r.onFocusableItemAdd()}),ee(()=>{n.focusable&&r.onFocusableItemRemove()});function g(e){if(e.key==="Tab"&&e.shiftKey){r.onItemShiftTab();return}if(e.target!==e.currentTarget)return;const a=ie(e,r.orientation.value,r.dir.value);if(a!==void 0){if(e.metaKey||e.ctrlKey||e.altKey||!n.allowShiftKey&&e.shiftKey)return;e.preventDefault();let o=[...m().map(l=>l.ref).filter(l=>l.dataset.disabled!=="")];if(a==="last")o.reverse();else if(a==="prev"||a==="next"){a==="prev"&&o.reverse();const l=o.indexOf(e.currentTarget);o=r.loop.value?le(o,l+1):o.slice(l+1)}te(()=>D(o))}}return(e,a)=>(K(),x(d(F),null,{default:A(()=>[O(d(B),{tabindex:S.value?0:-1,"data-orientation":d(r).orientation.value,"data-active":e.active?"":void 0,"data-disabled":e.focusable?void 0:"",as:e.as,"as-child":e.asChild,onMousedown:a[0]||(a[0]=o=>{e.focusable?d(r).onItemFocus(i.value):o.preventDefault()}),onFocus:a[1]||(a[1]=o=>d(r).onItemFocus(i.value)),onKeydown:g},{default:A(()=>[P(e.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}}),ge=fe;export{ne as M,me as R,ge as a,N as u};
